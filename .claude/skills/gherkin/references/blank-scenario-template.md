# 빈 시나리오 템플릿

## 목적
Phase A에서 사용자가 직접 Gherkin 문법으로 시나리오를 작성하여 테스트 사고력을 훈련한다.

---

## 파일 생성 템플릿 (Phase A)

이 템플릿은 `.atdd/scenarios/draft-happy-path.md` 파일로 생성된다.

```gherkin
Feature: [기능명 - 요구사항에서 추출]
  # 관련 요구사항: M1, M2, ...

  Background:
    Given 데이터베이스가 초기화되어 있다
    # 추가 공통 전제조건이 있으면 아래에 작성
    # And [공통 전제조건]

  # ============================================
  # Happy Path (정상 흐름)
  # ============================================

  @happy
  Scenario: 정상적인 [기능명]
    # Given: 선행 데이터/상태를 Data Table로 명시
    Given 다음 [엔티티명]가 존재한다
      | id | 필드1 | 필드2 |
      | 1  | 값1   | 값2   |

    # When: 사용자 행동 + 요청 데이터
    When [엔티티명] [행동] 요청을 보낸다
      | 필드1 | 필드2 | 필드3 |
      | 값1   | 값2   | 값3   |

    # Then: 상태 코드 + 응답 검증
    Then 상태 코드 201을 받는다
    And 응답의 "필드1" 필드는 "값1"이다
    # And [추가 검증]

  # ============================================
  # Edge Cases (예외 흐름) - 아래에 추가
  # ============================================

  @edge @validation
  Scenario: [필수값 누락/형식 오류]
    # Given: (필요시 선행 조건)

    When [엔티티명] [행동] 요청을 보낸다
      | 필드1 | 필드2 |
      |       | 값2   |  # 필수값 누락

    Then 상태 코드 400을 받는다
    And 에러 메시지는 "[에러메시지]"이다

  @edge @business
  Scenario: [비즈니스 규칙 위반]
    Given 다음 [엔티티명]가 존재한다
      | id | 상태필드 |
      | 1  | [상태값] |

    When [엔티티명] [행동] 요청을 보낸다: 1

    Then 상태 코드 400을 받는다
    And 에러 메시지는 "[비즈니스규칙위반메시지]"이다
```

---

## 작성 체크리스트

### Given 체크
- [ ] 구체적 데이터 ID/값 명시 (`| id | name |`)
- [ ] 선행 조건 있으면 추가 (`And 로그인되어 있다`)

### When 체크
- [ ] 단일 행동만 작성
- [ ] 요청 파라미터는 Data Table로

### Then 체크
- [ ] HTTP 상태 코드 명시 (`201`, `400`, `404`, `409`)
- [ ] 응답 필드 검증 (`응답의 "email" 필드는 "test@test.com"이다`)

---

## Step 네이밍 패턴 (복사해서 사용)

| Step | 패턴 | 예시 |
|------|------|------|
| Given | `다음 {엔티티}가 존재한다` | `다음 사용자가 존재한다` |
| Given | `다음 {엔티티}가 {상태} 상태이다` | `다음 주문이 취소 상태이다` |
| Given | `{역할}로 로그인되어 있다` | `관리자로 로그인되어 있다` |
| When | `{엔티티} {행동} 요청을 보낸다` | `회원가입 요청을 보낸다` |
| When | `{엔티티} {행동} 요청을 보낸다: {id}` | `주문 조회 요청을 보낸다: 1` |
| Then | `상태 코드 {code}을 받는다` | `상태 코드 201을 받는다` |
| Then | `응답의 "{field}" 필드는 "{value}"이다` | `응답의 "email" 필드는 "test@test.com"이다` |
| Then | `에러 메시지는 "{message}"이다` | `에러 메시지는 "이미 존재하는 이메일입니다"이다` |

---

## HTTP 상태 코드 가이드

| 코드 | 상황 | 예시 |
|------|------|------|
| 200 | 조회/수정 성공 | 정상 조회 |
| 201 | 생성 성공 | 회원가입, 주문 생성 |
| 204 | 삭제 성공 | 리소스 삭제 |
| 400 | 입력 검증 실패 | 필수값 누락, 형식 오류 |
| 401 | 인증 실패 | 로그인 필요 |
| 403 | 권한 없음 | 관리자 기능에 일반 사용자 접근 |
| 404 | 리소스 없음 | 존재하지 않는 ID 조회 |
| 409 | 비즈니스 충돌 | 중복 데이터, 상태 위반 |

---

## 태그 규칙

| 태그 | 용도 |
|------|------|
| `@happy` | Happy Path 시나리오 |
| `@edge` | Edge Case 시나리오 |
| `@validation` | 입력 검증 관련 |
| `@business` | 비즈니스 규칙 관련 |
| `@auth` | 인증/권한 관련 |

---

## 작성 예시 (참고용)

```gherkin
Feature: 회원가입
  # 관련 요구사항: M1, M2, S1

  Background:
    Given 데이터베이스가 초기화되어 있다

  @happy
  Scenario: 정상적인 회원가입
    When 회원가입 요청을 보낸다
      | email         | password     | name   |
      | test@test.com | password123! | 테스터 |
    Then 상태 코드 201을 받는다
    And 응답의 "email" 필드는 "test@test.com"이다

  @edge @validation
  Scenario: 이메일 누락으로 회원가입 실패
    When 회원가입 요청을 보낸다
      | email | password     | name   |
      |       | password123! | 테스터 |
    Then 상태 코드 400을 받는다
    And 에러 메시지는 "이메일은 필수입니다"이다

  @edge @business
  Scenario: 중복 이메일로 회원가입 실패
    Given 다음 사용자가 존재한다
      | id | email         |
      | 1  | test@test.com |
    When 회원가입 요청을 보낸다
      | email         | password     | name   |
      | test@test.com | password456! | 테스터2 |
    Then 상태 코드 409을 받는다
    And 에러 메시지는 "이미 존재하는 이메일입니다"이다
```

---

## STOP Protocol (Phase A 완료)

```
---
📁 파일 생성 완료: .atdd/scenarios/draft-happy-path.md
👆 파일을 열어 핵심 시나리오(Happy Path)를 작성해주세요.
작성 완료 후 "완료" 또는 "다음"이라고 입력해주세요.
Phase B (Edge Case Hunt)로 진행합니다.
```
