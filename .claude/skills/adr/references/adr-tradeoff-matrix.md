# ADR Trade-off Matrix Guide

## 개요

Trade-off Matrix는 여러 대안을 객관적인 기준으로 비교 평가하는 도구다.
각 대안의 장단점을 시각화하여 의사결정의 투명성을 높인다.

---

## Trade-off Matrix Template

### 기본 형식

```markdown
| 평가기준 | 대안1 (선택) | 대안2 | 대안3 |
|----------|--------------|-------|-------|
| 기준1    | ⭐⭐⭐       | ⭐⭐  | ⭐⭐⭐⭐ |
| 기준2    | ⭐⭐         | ⭐⭐⭐ | ⭐⭐⭐⭐⭐ |
| 기준3    | ⭐⭐⭐⭐⭐    | ⭐    | ⭐⭐   |
| **총점** | **10**       | **6** | **11** |

### 선택 설명
총점이 가장 높은 대안3이 아닌 대안1을 선택한 이유:
- [트레이드오프 설명]
```

### 확장 형식 (가중치 적용)

```markdown
| 평가기준 | 가중치 | 대안1 | 대안2 | 대안3 |
|----------|--------|-------|-------|-------|
| 성능     | 3      | 3 (9) | 2 (6) | 4 (12)|
| 확장성   | 2      | 2 (4) | 3 (6) | 5 (10)|
| 팀 친숙도| 4      | 5 (20)| 1 (4) | 2 (8) |
| **가중 총점** | | **33** | **16** | **30** |

### 가중치 선정 이유
- 팀 친숙도(4): 현재 팀 규모와 일정 고려 시 가장 중요
- 성능(3): 현재 요구사항 충족이 최우선
- 확장성(2): 1년 내로는 낮은 우선순위
```

---

## 평가 기준 예시

### 기술적 기준

| 기준 | 설명 | 평가 방법 |
|------|------|-----------|
| 성능 | 응답 시간, 처리량 | 벤치마크, POC 결과 |
| 확장성 | 트래픽/데이터 증가 대응 | 아키텍처 분석 |
| 신뢰성 | 장애 허용, 복구 | SLA, 장애 시나리오 |
| 보안 | 취약점, 컴플라이언스 | 보안 감사, CVE |
| 복잡도 | 구현/운영 난이도 | 아키텍처 복잡도 |

### 운영적 기준

| 기준 | 설명 | 평가 방법 |
|------|------|-----------|
| 팀 친숙도 | 팀의 경험치 | 이력, 인터뷰 |
| 운영 부담 | 모니터링, 장애 대응 | 운영 매뉴얼 복잡도 |
| 커뮤니티 | 문서, 서포트 | StackOverflow, GitHub Stars |
| 생태계 | 도구, 라이브러리 | 패키지 매니저 통계 |

### 비즈니스 기준

| 기준 | 설명 | 평가 방법 |
|------|------|-----------|
| 비용 | 라이선스, 인프라 | TCO 계산 |
| 일정 | 구현 소요 시간 | POC, 유추 |
| 위험 | 실패 가능성 | Pre-Mortem 결과 |
| 전략적 적합성 | 회사 기술 전략 | CTO/아키텍트 의견 |

---

## 별점 vs 점수 체계

### 별점 체계 (5점 만점)

```
⭐      = 1점 (매우 나쁨)
⭐⭐    = 2점 (나쁨)
⭐⭐⭐  = 3점 (보통)
⭐⭐⭐⭐ = 4점 (좋음)
⭐⭐⭐⭐⭐ = 5점 (매우 좋음)
```

### 점수만 표시 (간결함)

```
| 성능 | 3 | 2 | 4 |
```

---

## Trade-off Matrix 작성 프로세스

### Step 1: 대안 식별 (최소 3개)

```markdown
- 대안1: MySQL 8.0 (선택 예정)
- 대안2: PostgreSQL 15
- 대안3: MongoDB 7.0
- 대안4: CockroachDB (선택적)
```

### Step 2: 평가 기준 선정

```markdown
비즈니스 맥락을 고려하여 3~5개 기준 선정:
- 성능 (현재 요구사항 충족)
- 확장성 (향후 성장 대응)
- 팀 친숙도 (개발 속도)
- 비용 (라이선스 + 인프라)
```

### Step 3: 각 대안 평가

```markdown
| 평가기준 | MySQL | PostgreSQL | MongoDB |
|----------|-------|------------|---------|
| 성능     | 4     | 4          | 3       |
| 확장성   | 2     | 3          | 5       |
| 팀 친숙도| 5     | 2          | 1       |
| 비용     | 4     | 5          | 3       |
```

### Step 4: 총점 계산 및 트레이드오프 설명

```markdown
| **총점** | **15** | **14** | **12** |

### 선택 설명
MySQL(15점) 선택. PostgreSQL과 점수 차이가 적지만:
1. 팀 친숙도 5점 → 개발 속도 2배 빠름
2. 운영 경험 있어 장애 대응 빠름
3. 단점: 확장성 2점 → DAU 50만 돌파 시 재검토 필요
```

---

## 실패 시나리오 포함

각 대안에 "실패 시나리오"를 추가하여 언제 이 선택이 틀릴 수 있는지 명시한다.

```markdown
### 대안별 실패 시나리오

| 대안 | 언제 실패하는가? |
|------|------------------|
| MySQL | 단일 테이블 1억 건 초과 시 쿼리 성능 급격히 저하 |
| PostgreSQL | 복잡한 JSON 쿼리 필요 시 인덱싱 한계 |
| MongoDB | 트랜잭션 필요 시 ACID 보장 어려움 |
```

---

## 예시: 인증 방식 선택

```markdown
## Trade-off Matrix

| 평가기준 | JWT (선택) | Session+Redis | OAuth |
|----------|------------|---------------|-------|
| 성능     | 5          | 3             | 3     |
| 보안     | 2          | 4             | 5     |
| 확장성   | 5          | 3             | 4     |
| 팀 친숙도| 4          | 5             | 2     |
| **총점** | **16**     | **15**        | **14** |

### 선택 설명
JWT 선택. Session+Redis와 점수 차이가 적지만:
- 성능 5점: 서버 상태 불필요, 수평 확장 용이
- 확장성 5점: MSA 전환 시 이점

### 트레이드오프 인지 사항
- 보안 2점: 토큰 탈취 시 폐기 불가 → 짧은 만료시간 + Refresh Token 사용
- 실패 시나리오: 실시간 권한 변경 필요 시 Session 방식으로 재검토

### 대안별 실패 시나리오

| 대안 | 실패 조건 |
|------|-----------|
| JWT | 권한 변경 즉시 반영 필요 시 실패 |
| Session+Redis | Redis 장애 시 전체 로그아웃 발생 |
| OAuth | 외부 프로바이더 장애 시 서비스 마비 |
```

---

## 예시: 메시지 큐 선택

```markdown
## Trade-off Matrix

| 평가기준 | RabbitMQ | Kafka (선택) | SQS |
|----------|----------|--------------|-----|
| 메시지 순서 보장 | 3 | 5 | 2 |
| 처리량 | 3 | 5 | 4 |
| 운영 복잡도 | 3 | 2 | 5 |
| 비용 | 4 | 3 | 3 |
| 팀 친숙도 | 4 | 3 | 2 |
| **총점** | **17** | **18** | **16** |

### 선택 설명
Kafka 선택. 총점은 RabbitMQ와 비슷하지만:
- 메시지 순서 보장 5점: 이벤트 소싱 패턴에 필수
- 처리량 5점: 향후 트래픽 10배 증가 대비

### 트레이드오프 인지 사항
- 운영 복잡도 2점: 전담 인력 필요 → Kafka 경험자 채용 또는 Confluent Cloud 검토
- 비용 3점: 초기 인프라 비용 높음

### 대안별 실패 시나리오

| 대안 | 실패 조건 |
|------|-----------|
| RabbitMQ | 메시지 10만/초 초과 시 지연 발생 |
| Kafka | 운영 인력 부족 시 장애 대응 실패 |
| SQS | Vendor lock-in으로 비용 증가 |
```

---

## Trade-off Matrix 작성 팁

### Do's
- 최소 3개 대안 포함
- 비즈니스 맥락에 맞는 기준 선정
- 총점이 낮은 대안을 선택한 경우 명확한 이유 제시
- 각 대안의 실패 시나리오 포함

### Don'ts
- 사전에 결론을 정하고 Matrix를 맞추지 않음
- 너무 많은 평가 기준 (5개 이하 권장)
- 정성적 기준만 사용 (가능한 정량화)
- 총점만 보고 선택 (트레이드오프 설명 필수)

---

## 참조

- "Decision Matrix Analysis" - Mind Tools
- "Weighted Decision Matrix" - Project Management Institute
- "Trade-off Analysis Methods" - NASA Systems Engineering Handbook
